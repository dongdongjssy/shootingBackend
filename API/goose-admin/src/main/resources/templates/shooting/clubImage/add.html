<!DOCTYPE HTML>
<html  lang="zh" xmlns:th="http://www.thymeleaf.org">
<meta charset="utf-8">
<head th:include="include :: header"></head>
<link th:href="@{/ajax/libs/cropbox/cropbox.css}" rel="stylesheet"/>
<body class="white-bg">
    <div class="wrapper wrapper-content animated fadeInRight ibox-content">
        <form class="form-horizontal m" id="form-clubImage-add">
			<div class="form-group">
				<label class="col-sm-3 control-label">俱乐部：</label>
				<div class="col-sm-8">
					<select id="clubId" name="clubId" class="form-control">
						<option th:each="fkRow:${ clubIdList}" th:value="${ fkRow.id}" th:text="${ fkRow.title}" ></option>
					</select>					
				</div>
			</div>
			<div class="form-group">	
				<label class="col-sm-3 control-label">图集链接1：</label>
				<div class="col-sm-8">
			       <div class="new-contentarea">
			           <a href="javascript:void(0)" class="upload-img"> <label for="picture">上传图像</label> </a> 
			           <input type="file" id="uploadFile" class="" name="image1"  accept="image/*"/>
			       </div>					
				</div>
			</div>
			<div class="form-group">
				<label class="col-sm-3 control-label"></label>
				<div class="col-sm-8" id="sDiv">
					<div class="col-sm-12" id="imgDiv" >
					</div>
				</div>
				<div class="col-sm-8" hidden id="hDiv">
					<img src="" id="bgPic" style="width: 100%;height: 100%">
				</div>
			</div>
			<!--<div class="form-group">
				<label class="col-sm-3 control-label">图片预览：</label>
				<div class="col-sm-8">
					<div class="container"> 
			       		<img id="imgpreviewimage1" class='imageBox' />
			        </div>				
				</div>
			</div>
			<div class="form-group">	
				<label class="col-sm-3 control-label">图集链接2：</label>
				<div class="col-sm-8">
			       <div class="new-contentarea">
			           <a href="javascript:void(0)" class="upload-img"> <label for="picture">上传图像</label> </a> 
			           <input type="file" class="" name="image2" id="image2" accept="image/*"/>
			       </div>					
				</div>
			</div>
			<div class="form-group">	
				<label class="col-sm-3 control-label">图片预览：</label>
				<div class="col-sm-8">
					<div class="container"> 
			       		<img id="imgpreviewimage2" class='imageBox' />
			        </div>				
				</div>
			</div>
			<div class="form-group">	
				<label class="col-sm-3 control-label">图集链接3：</label>
				<div class="col-sm-8">
			       <div class="new-contentarea">
			           <a href="javascript:void(0)" class="upload-img"> <label for="picture">上传图像</label> </a> 
			           <input type="file" class="" name="image3" id="image3" accept="image/*"/>
			       </div>					
				</div>
			</div>
			<div class="form-group">	
				<label class="col-sm-3 control-label">图片预览：</label>
				<div class="col-sm-8">
					<div class="container"> 
			       		<img id="imgpreviewimage3" class='imageBox' />
			        </div>				
				</div>
			</div>
			<div class="form-group">	
				<label class="col-sm-3 control-label">图集链接4：</label>
				<div class="col-sm-8">
			       <div class="new-contentarea">
			           <a href="javascript:void(0)" class="upload-img"> <label for="picture">上传图像</label> </a> 
			           <input type="file" class="" name="image4" id="image4" accept="image/*"/>
			       </div>					
				</div>
			</div>
			<div class="form-group">	
				<label class="col-sm-3 control-label">图片预览：</label>
				<div class="col-sm-8">
					<div class="container"> 
			       		<img id="imgpreviewimage4" class='imageBox' />
			        </div>				
				</div>
			</div>
			<div class="form-group">	
				<label class="col-sm-3 control-label">图集链接5：</label>
				<div class="col-sm-8">
			       <div class="new-contentarea">
			           <a href="javascript:void(0)" class="upload-img"> <label for="picture">上传图像</label> </a> 
			           <input type="file" class="" name="image5" id="image5" accept="image/*"/>
			       </div>					
				</div>
			</div>
			<div class="form-group">	
				<label class="col-sm-3 control-label">图片预览：</label>
				<div class="col-sm-8">
					<div class="container"> 
			       		<img id="imgpreviewimage5" class='imageBox' />
			        </div>				
				</div>
			</div>
			<div class="form-group">	
				<label class="col-sm-3 control-label">图集链接6：</label>
				<div class="col-sm-8">
			       <div class="new-contentarea">
			           <a href="javascript:void(0)" class="upload-img"> <label for="picture">上传图像</label> </a> 
			           <input type="file" class="" name="image6" id="image6" accept="image/*"/>
			       </div>					
				</div>
			</div>
			<div class="form-group">	
				<label class="col-sm-3 control-label">图片预览：</label>
				<div class="col-sm-8">
					<div class="container"> 
			       		<img id="imgpreviewimage6" class='imageBox' />
			        </div>				
				</div>
			</div>
			<div class="form-group">	
				<label class="col-sm-3 control-label">图集链接7：</label>
				<div class="col-sm-8">
			       <div class="new-contentarea">
			           <a href="javascript:void(0)" class="upload-img"> <label for="picture">上传图像</label> </a> 
			           <input type="file" class="" name="image7" id="image7" accept="image/*"/>
			       </div>					
				</div>
			</div>
			<div class="form-group">	
				<label class="col-sm-3 control-label">图片预览：</label>
				<div class="col-sm-8">
					<div class="container"> 
			       		<img id="imgpreviewimage7" class='imageBox' />
			        </div>				
				</div>
			</div>
			<div class="form-group">	
				<label class="col-sm-3 control-label">图集链接8：</label>
				<div class="col-sm-8">
			       <div class="new-contentarea">
			           <a href="javascript:void(0)" class="upload-img"> <label for="picture">上传图像</label> </a> 
			           <input type="file" class="" name="image8" id="image8" accept="image/*"/>
			       </div>					
				</div>
			</div>
			<div class="form-group">	
				<label class="col-sm-3 control-label">图片预览：</label>
				<div class="col-sm-8">
					<div class="container"> 
			       		<img id="imgpreviewimage8" class='imageBox' />
			        </div>				
				</div>
			</div>
			<div class="form-group">	
				<label class="col-sm-3 control-label">图集链接9：</label>
				<div class="col-sm-8">
			       <div class="new-contentarea">
			           <a href="javascript:void(0)" class="upload-img"> <label for="picture">上传图像</label> </a> 
			           <input type="file" class="" name="image9" id="image9" accept="image/*"/>
			       </div>					
				</div>
			</div>
			<div class="form-group">	
				<label class="col-sm-3 control-label">图片预览：</label>
				<div class="col-sm-8">
					<div class="container"> 
			       		<img id="imgpreviewimage9" class='imageBox' />
			        </div>				
				</div>
			</div>-->
		</form>
	</div>
    <div th:include="include::footer"></div>
    <script type="text/javascript">
		var prefix = ctx + "shooting/clubImage"
        var fileArr=[]
		$("#form-clubImage-add").validate({
			rules:{
				id: {
					required: false,
				},
				clubId: {
					required: false,
				},
				image1: {
					required: false,
				},
				image2: {
					required: false,
				},
				image3: {
					required: false,
				},
				image4: {
					required: false,
				},
				image5: {
					required: false,
				},
				image6: {
					required: false,
				},
				image7: {
					required: false,
				},
				image8: {
					required: false,
				},
				image9: {
					required: false,
				},
			},
			messages: {
				id: {
				},		
				clubId: {
				},		
				image1: {
				},		
				image2: {
				},		
				image3: {
				},		
				image4: {
				},		
				image5: {
				},		
				image6: {
				},		
				image7: {
				},		
				image8: {
				},		
				image9: {
				},		
		    }				
		});
	
		function submitHandler() {
			if ($.validate.form()) {
		        var formdata = new FormData();
				formdata.append("clubId", $("#clubId").val());


				/*var fileIdx = 0;
				fileIdx = $('input[type=file]').length-9;		
		        formdata.append("image1File", $('input[type=file]')[fileIdx].files[0]);
				fileIdx = $('input[type=file]').length-8;		
		        formdata.append("image2File", $('input[type=file]')[fileIdx].files[0]);
				fileIdx = $('input[type=file]').length-7;		
		        formdata.append("image3File", $('input[type=file]')[fileIdx].files[0]);
				fileIdx = $('input[type=file]').length-6;		
		        formdata.append("image4File", $('input[type=file]')[fileIdx].files[0]);
				fileIdx = $('input[type=file]').length-5;		
		        formdata.append("image5File", $('input[type=file]')[fileIdx].files[0]);
				fileIdx = $('input[type=file]').length-4;		
		        formdata.append("image6File", $('input[type=file]')[fileIdx].files[0]);
				fileIdx = $('input[type=file]').length-3;		
		        formdata.append("image7File", $('input[type=file]')[fileIdx].files[0]);
				fileIdx = $('input[type=file]').length-2;		
		        formdata.append("image8File", $('input[type=file]')[fileIdx].files[0]);
				fileIdx = $('input[type=file]').length-1;		
		        formdata.append("image9File", $('input[type=file]')[fileIdx].files[0]);*/
                for(var i in fileArr){
                    var data=fileArr[i]
                    i++
                    var fileName='image'+i+'File'
                    formdata.append(fileName,data);
                }
		        $.ajax({
		            url: prefix + "/add",
		            data: formdata,
		            type: "post",
		            processData: false,
		            contentType: false,
		            success: function(result) {
		            	$.operate.saveSuccess(result);
		            }
		        })
	        
	   		}	
		}
        function removePic(obj) {
            var name = obj.dataset.name;
            console.log(name)
            $(obj).parent().remove();
            for(var i in fileArr){
                if(fileArr[i].name = name){
                    fileArr.splice(i,1);
                    break;
                }
            }
        }
		
		$(window).load(function() {

			/*var optionsimage1 = {
			}	
		    $('#image1').on('change', function() {	    
		        var reader = new FileReader();
		        reader.onload = function(e) {
		            optionsimage1.imgSrc = e.target.result;
		            //根据MIME判断上传的文件是不是图片类型
		            if((optionsimage1.imgSrc).indexOf("image/")==-1){
		                parent.layer.alert("文件格式错误，请上传图片类型,如：JPG,JEPG，PNG后缀的文件。", {icon: 2,title:"系统提示"});
		            } else {
		            	$('#imgpreviewimage1').attr('src', e.target.result);
		            	$('#imgpreviewimage1').attr('hidden', false);		            	
		            }
		        }
		        reader.readAsDataURL(this.files[0]);
		    })	
			var optionsimage2 = {	
			}	
		    $('#image2').on('change', function() {	    
		        var reader = new FileReader();
		        reader.onload = function(e) {
		            optionsimage2.imgSrc = e.target.result;
		            //根据MIME判断上传的文件是不是图片类型
		            if((optionsimage2.imgSrc).indexOf("image/")==-1){
		                parent.layer.alert("文件格式错误，请上传图片类型,如：JPG,JEPG，PNG后缀的文件。", {icon: 2,title:"系统提示"});
		            } else {
		            	$('#imgpreviewimage2').attr('src', e.target.result);
		            	$('#imgpreviewimage2').attr('hidden', false);		            	
		            }
		        }
		        reader.readAsDataURL(this.files[0]);
		    })	
			var optionsimage3 = {	
			}	
		    $('#image3').on('change', function() {	    
		        var reader = new FileReader();
		        reader.onload = function(e) {
		            optionsimage3.imgSrc = e.target.result;
		            //根据MIME判断上传的文件是不是图片类型
		            if((optionsimage3.imgSrc).indexOf("image/")==-1){
		                parent.layer.alert("文件格式错误，请上传图片类型,如：JPG,JEPG，PNG后缀的文件。", {icon: 2,title:"系统提示"});
		            } else {
		            	$('#imgpreviewimage3').attr('src', e.target.result);
		            	$('#imgpreviewimage3').attr('hidden', false);		            	
		            }
		        }
		        reader.readAsDataURL(this.files[0]);
		    })	
			var optionsimage4 = {	
			}	
		    $('#image4').on('change', function() {	    
		        var reader = new FileReader();
		        reader.onload = function(e) {
		            optionsimage4.imgSrc = e.target.result;
		            //根据MIME判断上传的文件是不是图片类型
		            if((optionsimage4.imgSrc).indexOf("image/")==-1){
		                parent.layer.alert("文件格式错误，请上传图片类型,如：JPG,JEPG，PNG后缀的文件。", {icon: 2,title:"系统提示"});
		            } else {
		            	$('#imgpreviewimage4').attr('src', e.target.result);
		            	$('#imgpreviewimage4').attr('hidden', false);		            	
		            }
		        }
		        reader.readAsDataURL(this.files[0]);
		    })	
			var optionsimage5 = {	
			}	
		    $('#image5').on('change', function() {	    
		        var reader = new FileReader();
		        reader.onload = function(e) {
		            optionsimage5.imgSrc = e.target.result;
		            //根据MIME判断上传的文件是不是图片类型
		            if((optionsimage5.imgSrc).indexOf("image/")==-1){
		                parent.layer.alert("文件格式错误，请上传图片类型,如：JPG,JEPG，PNG后缀的文件。", {icon: 2,title:"系统提示"});
		            } else {
		            	$('#imgpreviewimage5').attr('src', e.target.result);
		            	$('#imgpreviewimage5').attr('hidden', false);		            	
		            }
		        }
		        reader.readAsDataURL(this.files[0]);
		    })	
			var optionsimage6 = {	
			}	
		    $('#image6').on('change', function() {	    
		        var reader = new FileReader();
		        reader.onload = function(e) {
		            optionsimage6.imgSrc = e.target.result;
		            //根据MIME判断上传的文件是不是图片类型
		            if((optionsimage6.imgSrc).indexOf("image/")==-1){
		                parent.layer.alert("文件格式错误，请上传图片类型,如：JPG,JEPG，PNG后缀的文件。", {icon: 2,title:"系统提示"});
		            } else {
		            	$('#imgpreviewimage6').attr('src', e.target.result);
		            	$('#imgpreviewimage6').attr('hidden', false);		            	
		            }
		        }
		        reader.readAsDataURL(this.files[0]);
		    })	
			var optionsimage7 = {	
			}	
		    $('#image7').on('change', function() {	    
		        var reader = new FileReader();
		        reader.onload = function(e) {
		            optionsimage7.imgSrc = e.target.result;
		            //根据MIME判断上传的文件是不是图片类型
		            if((optionsimage7.imgSrc).indexOf("image/")==-1){
		                parent.layer.alert("文件格式错误，请上传图片类型,如：JPG,JEPG，PNG后缀的文件。", {icon: 2,title:"系统提示"});
		            } else {
		            	$('#imgpreviewimage7').attr('src', e.target.result);
		            	$('#imgpreviewimage7').attr('hidden', false);		            	
		            }
		        }
		        reader.readAsDataURL(this.files[0]);
		    })	
			var optionsimage8 = {	
			}	
		    $('#image8').on('change', function() {	    
		        var reader = new FileReader();
		        reader.onload = function(e) {
		            optionsimage8.imgSrc = e.target.result;
		            //根据MIME判断上传的文件是不是图片类型
		            if((optionsimage8.imgSrc).indexOf("image/")==-1){
		                parent.layer.alert("文件格式错误，请上传图片类型,如：JPG,JEPG，PNG后缀的文件。", {icon: 2,title:"系统提示"});
		            } else {
		            	$('#imgpreviewimage8').attr('src', e.target.result);
		            	$('#imgpreviewimage8').attr('hidden', false);		            	
		            }
		        }
		        reader.readAsDataURL(this.files[0]);
		    })	
			var optionsimage9 = {	
			}	
		    $('#image9').on('change', function() {	    
		        var reader = new FileReader();
		        reader.onload = function(e) {
		            optionsimage9.imgSrc = e.target.result;
		            //根据MIME判断上传的文件是不是图片类型
		            if((optionsimage9.imgSrc).indexOf("image/")==-1){
		                parent.layer.alert("文件格式错误，请上传图片类型,如：JPG,JEPG，PNG后缀的文件。", {icon: 2,title:"系统提示"});
		            } else {
		            	$('#imgpreviewimage9').attr('src', e.target.result);
		            	$('#imgpreviewimage9').attr('hidden', false);		            	
		            }
		        }
		        reader.readAsDataURL(this.files[0]);
		    })*/


            $("#uploadFile").on("change",function(){

               /* var num= $("#imgDiv").children("div").length;
                if(num>=9){
                    layer.msg("最多上传9张图片")
                    return
                }*/
                var ss=document.getElementById('uploadFile').files[0]
                fileArr.push(ss)
                var objUrl = getObjectURL(this.files[0]) ; //获取图片的路径，该路径不是图片在本地的路径
                if (objUrl) {
                    var pic = '<div id="imagepreview' + Math.floor(Math.random() * 1000000) + '" class="col-sm-4" style="position: relative; padding-top: 15px;"><img src="' + objUrl + '" width="100%" height="100px" class="smPic" ><span onclick="removePic(this)" data-name=" '+ss.name+'" style="position: absolute;display: block;width: 20px;height:20px;color: #fff;background: rgba(0,0,0,0.7);line-height: 20px;text-align: center;border-radius: 50%;top: 20px;right: 20px;cursor: pointer;">x</span></div>'
                    $("#imgDiv").append(pic) ; //将图片路径存入src中，显示出图片
                }


                $(".smPic").click(function () {
                    var picSrc =  $(this).attr('src')
                    $('#bgPic').attr('src',picSrc)
                    $('#sDiv').hide()
                    $("#hDiv").show()
                })

                $('#hDiv').on('click',function(){
                    $('#bgPic').removeAttr('src')
                    $('#hDiv').hide()
                    $('#sDiv').show()
                })

            });




            function getObjectURL(file) {
                var url = null ;
                if (window.createObjectURL!=undefined) { // basic
                    url = window.createObjectURL(file) ;
                } else if (window.URL!=undefined) { // mozilla(firefox)
                    url = window.URL.createObjectURL(file) ;
                } else if (window.webkitURL!=undefined) { // webkit or chrome
                    url = window.webkitURL.createObjectURL(file) ;
                }
                return url ;
            }

            function removePic1(obj) {
                var name = obj.dataset.name;
                console.log(name)
                $(obj).parent().remove();
                for(var i in fileArr){
                    if(fileArr[i].name = name){
                        fileArr.splice(i,1);
                        break;
                    }
                }
            }
		});

	    
	</script>
</body>
</html>
